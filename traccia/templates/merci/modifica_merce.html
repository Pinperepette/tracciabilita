{% extends 'base.html' %}

{% block title %}Modifica Merce{% endblock %}

{% block content %}
    <h2 class="my-4">Modifica Merce</h2>
    
    <form method="POST" enctype="multipart/form-data">
        <!-- Nome Merce -->
        <div class="form-group">
            <label for="nome_merce">Nome Merce</label>
            <input type="text" class="form-control" id="nome_merce" name="nome_merce" value="{{ merce['nome_merce'] }}" required>
        </div>

        <!-- Selezione Materia Prima -->
        <div class="form-group">
            <label for="materia_id">Materia Prima</label>
            <select class="form-control" id="materia_id" name="materia_id" required>
                {% for materia in materie_prime %}
                <option value="{{ materia['id'] }}" {% if materia['id'] == merce['materia_id'] %}selected{% endif %}>
                    {{ materia['nome'] }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Selezione Fornitore -->
        <div class="form-group">
            <label for="fornitore_id">Fornitore</label>
            <select class="form-control" id="fornitore_id" name="fornitore_id" required>
                {% for fornitore in fornitori %}
                <option value="{{ fornitore['id'] }}" {% if fornitore['id'] == merce['fornitore_id'] %}selected{% endif %}>
                    {{ fornitore['ragione_sociale'] }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Prezzo per kg -->
        <div class="form-group">
            <label for="prezzo_kg">Prezzo per kg</label>
            <input type="number" step="0.01" class="form-control" id="prezzo_kg" name="prezzo_kg" value="{{ merce['prezzo_kg'] }}" required>
        </div>

        <!-- Valori Nutrizionali -->
        <div class="form-group">
            <label for="proteine">Proteine (g)</label>
            <input type="number" step="0.01" class="form-control" id="proteine" name="proteine" value="{{ merce['proteine'] }}" required>
        </div>

        <div class="form-group">
            <label for="carboidrati">Carboidrati (g)</label>
            <input type="number" step="0.01" class="form-control" id="carboidrati" name="carboidrati" value="{{ merce['carboidrati'] }}" required>
        </div>

        <div class="form-group">
            <label for="grassi">Grassi (g)</label>
            <input type="number" step="0.01" class="form-control" id="grassi" name="grassi" value="{{ merce['grassi'] }}" required>
        </div>

        <div class="form-group">
            <label for="zuccheri">Zuccheri (g)</label>
            <input type="number" step="0.01" class="form-control" id="zuccheri" name="zuccheri" value="{{ merce['zuccheri'] }}" required>
        </div>

        <div class="form-group">
            <label for="grassi_saturi">Grassi Saturi (g)</label>
            <input type="number" step="0.01" class="form-control" id="grassi_saturi" name="grassi_saturi" value="{{ merce['grassi_saturi'] }}" required>
        </div>

        <div class="form-group">
            <label for="fibre_alimentari">Fibre Alimentari (g)</label>
            <input type="number" step="0.01" class="form-control" id="fibre_alimentari" name="fibre_alimentari" value="{{ merce['fibre_alimentari'] }}" required>
        </div>

        <!-- Selezione UE / non UE -->
        <div class="form-group">
            <label for="ue">UE / non UE</label>
            <select class="form-control" id="ue" name="ue" required>
                <option value="UE" {% if merce['ue'] == 'UE' %}selected{% endif %}>UE</option>
                <option value="non UE" {% if merce['ue'] == 'non UE' %}selected{% endif %}>Non UE</option>
            </select>
        </div>

        <!-- Caricamento Scheda Tecnica -->
        <div class="form-group">
            <label for="scheda">Scheda Tecnica</label>
            <input type="file" class="form-control-file" id="scheda" name="scheda">
            {% if merce['scheda_tecnica'] %}
            <p>Scheda tecnica attuale: <a href="{{ url_for('static', filename='schede_tecniche_materie_prime/' ~ merce['scheda_tecnica']) }}">{{ merce['scheda_tecnica'] }}</a></p>
            {% endif %}
        </div>

        <!-- Pulsanti -->
        <button type="submit" class="btn btn-primary">Salva Modifiche</button>
        <a href="{{ url_for('merci.index') }}" class="btn btn-secondary">Annulla</a>
    </form>
{% endblock %}
